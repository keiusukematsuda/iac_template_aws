# レポジトリについて

AWSのIaCをTerraformで行う際のテンプレート。

# 方針

- なるべくファイル単体で完結できるようにする(不要なリソースはファイルを削除すればよい)
  - IAMやセキュリティグループをそれ用のTFファイルに外出ししない
- 各リソースごとのパラメーターはそのリソースのTFファイルにlocalとして定義、リソースをまたぐもの(プロジェクト名など)についてはvariables.tfに記載
- 基本的にfor_eachを利用したループでリソースを作成する。ただし例外あり
  - 例外
    - ループ処理で作成するのが難しいリソース(セキュリティグループなど)

# ファイル構成

```
# summary
作成されるリソース

# data
dataなどで外部データを取得

# parameter
使用するパラメータをlocalで定義

# main
メインのリソース

# sub
メインのリソースが使用するリソース
例えば以下のようなリソース
- セキュリティグループ
- IAMロール
- VPCエンドポイント

# dependent
他のファイルに依存している箇所

```


# 編集方法

- 基本的にファイルを削除/追加するだけでOK
  - 外だしファイルがある場合は、同じ名前のディレクトリ(.tfはなし)は配下に格納する

# 手動対応が必要な箇所

- tfstate管理用のバケットの作成
  - backendをS3にする時(localの時は不要)
  - バケット名は[プロジェクト名]-[環境]-bucket-tfstate
- キーペアの作成
  - EC2を作成する時
- SSM Parameter Store
  - RDS Aurora Password (RDS Auroraを作成する時)